"use strict";(self.webpackChunkdisenos_agarcia_frontend=self.webpackChunkdisenos_agarcia_frontend||[]).push([[957],{957:(x,p,s)=>{s.r(p),s.d(p,{FavoritesComponent:()=>M});var l=s(177),g=s(6544),c=s(4341),t=s(4438),m=s(7326),_=s(6868),u=s(4796),f=s(2499);function h(a,d){if(1&a){const e=t.RV6();t.j41(0,"div",27)(1,"div",28)(2,"div",29)(3,"a",30),t.bIt("click",function(){const o=t.eBV(e).$implicit,r=t.XpG();return t.Njj(r.goToProduct(o.idProducto))}),t.nrm(4,"img",31),t.k0s()(),t.j41(5,"div",32)(6,"h5",33),t.EFF(7),t.k0s(),t.j41(8,"div",34)(9,"button",35),t.bIt("click",function(){const o=t.eBV(e).$implicit,r=t.XpG();return t.Njj(r.toggleFavorite(o))}),t.nrm(10,"i",36),t.k0s(),t.j41(11,"span",37),t.EFF(12),t.k0s(),t.j41(13,"button",35),t.bIt("click",function(){const o=t.eBV(e).$implicit,r=t.XpG();return t.Njj(r.toggleCart(o))}),t.nrm(14,"i"),t.k0s()()()()()}if(2&a){const e=d.$implicit,n=t.XpG();t.R7$(4),t.Y8G("src",n.getProductImagePath(e),t.B4B)("alt",e.nombre),t.R7$(3),t.JRh(e.nombre),t.R7$(2),t.Y8G("disabled",n.loadingFavorites),t.R7$(3),t.SpI("",e.precio,"\u20ac"),t.R7$(),t.Y8G("disabled",n.loadingCart),t.R7$(),t.HbH(n.getCartIconClass(e.idProducto))}}function b(a,d){1&a&&(t.j41(0,"div",38)(1,"div",39)(2,"h4"),t.EFF(3,"No tienes productos favoritos"),t.k0s(),t.j41(4,"p"),t.EFF(5,"Explora nuestra tienda y a\xf1ade productos a tus favoritos."),t.k0s(),t.j41(6,"a",40),t.EFF(7,"Ir a la tienda"),t.k0s()()())}function v(a,d){1&a&&(t.j41(0,"div",38)(1,"h4"),t.EFF(2,"Cargando favoritos..."),t.k0s()())}function P(a,d){if(1&a){const e=t.RV6();t.j41(0,"li",42)(1,"a",43),t.bIt("click",function(o){const r=t.eBV(e).$implicit,i=t.XpG(2);return t.Njj(i.changePage(r,o))}),t.EFF(2),t.k0s()()}if(2&a){const e=d.$implicit,n=t.XpG(2);t.AVh("active",e===n.currentPage),t.R7$(2),t.JRh(e)}}function C(a,d){if(1&a){const e=t.RV6();t.j41(0,"div",1)(1,"ul",41)(2,"li",42)(3,"a",43),t.bIt("click",function(o){t.eBV(e);const r=t.XpG();return t.Njj(r.changePage(r.currentPage-1,o))}),t.EFF(4,"Anterior"),t.k0s()(),t.DNE(5,P,3,3,"li",44),t.j41(6,"li",42)(7,"a",43),t.bIt("click",function(o){t.eBV(e);const r=t.XpG();return t.Njj(r.changePage(r.currentPage+1,o))}),t.EFF(8,"Siguiente"),t.k0s()()()()}if(2&a){const e=t.XpG();t.R7$(2),t.AVh("disabled",1===e.currentPage),t.R7$(3),t.Y8G("ngForOf",e.getPageNumbers()),t.R7$(),t.AVh("disabled",e.currentPage===e.totalPages)}}let M=(()=>{class a{constructor(e,n,o,r,i){this.favoriteService=e,this.cartService=n,this.authService=o,this.imageService=r,this.router=i,this.favorites=[],this.filteredFavorites=[],this.paginatedFavorites=[],this.cartItems=[],this.selectedOrder="",this.currentPage=1,this.productsPerPage=27,this.totalPages=1,this.loading=!0,this.loadingFavorites=!1,this.loadingCart=!1,this.showLoginModal=!1}ngOnInit(){this.checkAuthAndLoadFavorites()}checkAuthAndLoadFavorites(){if(!this.authService.isAuthenticated())return this.showLoginModal=!0,void(this.loading=!1);this.loadFavorites(),this.loadCartItems()}loadFavorites(){this.loading=!0,this.favoriteService.getFavorites().subscribe({next:e=>{this.favorites=e.favoritos||e,this.applyFilters(),this.loading=!1},error:e=>{console.error("Error al cargar favoritos:",e),this.loading=!1}})}loadCartItems(){this.cartService.getCart().subscribe({next:e=>{this.cartItems="success"===e.status&&e.carrito?e.carrito:[]},error:e=>{console.error("Error al cargar carrito:",e),this.cartItems=[]}})}onOrderChange(){this.currentPage=1,this.applyFilters()}applyFilters(){let e=[...this.favorites];switch(this.selectedOrder){case"nombre":e.sort((n,o)=>n.nombre.localeCompare(o.nombre));break;case"precioMenor":e.sort((n,o)=>n.precio-o.precio);break;case"precioMayor":e.sort((n,o)=>o.precio-n.precio);break;case"cantidad_vendidos":e.sort((n,o)=>(o.cantidad_vendidos||0)-(n.cantidad_vendidos||0))}this.filteredFavorites=e,this.calculatePagination(),this.updatePaginatedFavorites()}calculatePagination(){this.totalPages=Math.ceil(this.filteredFavorites.length/this.productsPerPage)}updatePaginatedFavorites(){const e=(this.currentPage-1)*this.productsPerPage;this.paginatedFavorites=this.filteredFavorites.slice(e,e+this.productsPerPage)}changePage(e,n){n.preventDefault(),e>=1&&e<=this.totalPages&&(this.currentPage=e,this.updatePaginatedFavorites(),window.scrollTo({top:0,behavior:"smooth"}))}getPageNumbers(){const e=[];let o=Math.max(1,this.currentPage-1),r=Math.min(this.totalPages,o+3-1);r-o<2&&(o=Math.max(1,r-3+1));for(let i=o;i<=r;i++)e.push(i);return e}toggleFavorite(e){this.loadingFavorites||(this.loadingFavorites=!0,this.favoriteService.toggleFavorite(e.idProducto).subscribe({next:n=>{"removed"===n.status&&(this.favorites=this.favorites.filter(o=>o.idProducto!==e.idProducto),this.applyFilters()),this.loadingFavorites=!1},error:n=>{console.error("Error al modificar favoritos:",n),this.loadingFavorites=!1}}))}toggleCart(e){this.loadingCart||(this.loadingCart=!0,this.isProductInCart(e.idProducto)?this.cartService.removeFromCart(e.idProducto).subscribe({next:o=>{this.loadCartItems(),this.loadingCart=!1},error:o=>{console.error("Error al eliminar del carrito:",o),this.loadingCart=!1}}):this.cartService.addToCart(e.idProducto).subscribe({next:o=>{this.loadCartItems(),this.loadingCart=!1},error:o=>{console.error("Error al a\xf1adir al carrito:",o),this.loadingCart=!1}}))}goToProduct(e){this.router.navigate(["/product",e])}goToShop(){this.router.navigate(["/shop"])}getProductImagePath(e){return this.imageService.getProductImagePath({category:e.categoria||"",subcategory:e.subcategoria,image:e.foto})}getCartIconClass(e){return this.isProductInCart(e)?"fas fa-trash":"fas fa-cart-plus"}isProductInCart(e){return this.cartItems.some(n=>n.idProducto===e)}closeLoginModal(){this.showLoginModal=!1,this.router.navigate(["/shop"])}static{this.\u0275fac=function(n){return new(n||a)(t.rXU(m.U),t.rXU(_.m),t.rXU(u.u),t.rXU(f.f),t.rXU(g.Ix))}}static{this.\u0275cmp=t.VBU({type:a,selectors:[["app-favorites"]],standalone:!0,features:[t.aNF],decls:40,vars:9,consts:[[1,"container","py-5","favoritos"],[1,"row"],[1,"col-lg-9","mx-auto"],[1,"col-md-6"],[1,"h2","pb-4"],[1,"col-md-6","pb-4"],[1,"d-flex"],[1,"form-control",3,"ngModelChange","change","ngModel"],["value",""],["value","cantidad_vendidos"],["value","nombre"],["value","precioMenor"],["value","precioMayor"],["id","product-container",1,"row"],["class","col-md-4",4,"ngFor","ngForOf"],["class","col-12 text-center",4,"ngIf"],["class","row",4,"ngIf"],["id","loginAlertModal","tabindex","-1","aria-labelledby","loginAlertModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","loginAlertModalLabel",1,"modal-title"],["type","button","aria-label","Cerrar",1,"btn-close",3,"click"],[1,"modal-body"],[1,"modal-footer"],["routerLink","/login",1,"btn","btn-primary"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"col-md-4"],[1,"card","mb-4","product-wap","rounded-0"],[1,"card","rounded-0"],[3,"click"],[1,"card-img","rounded-0","img-fluid",3,"src","alt"],[1,"card-body","d-flex","flex-column","align-items-center"],[1,"product-name","text-center"],[1,"d-flex","align-items-center","justify-content-center"],[1,"btn","btn-success","btn-lg",3,"click","disabled"],[1,"fas","fa-heart"],[1,"text-center","mx-2"],[1,"col-12","text-center"],[1,"alert","alert-info"],["routerLink","/shop",1,"btn","btn-success"],[1,"pagination","pagination-lg","justify-content-end"],[1,"page-item"],["href","#",1,"page-link","rounded-0","shadow-sm","text-dark","border-pagination",3,"click"],["class","page-item",3,"active",4,"ngFor","ngForOf"]],template:function(n,o){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",1)(4,"div",3)(5,"h1",4),t.EFF(6,"Mis Favoritos"),t.k0s()(),t.j41(7,"div",5)(8,"div",6)(9,"select",7),t.mxI("ngModelChange",function(i){return t.DH7(o.selectedOrder,i)||(o.selectedOrder=i),i}),t.bIt("change",function(){return o.onOrderChange()}),t.j41(10,"option",8),t.EFF(11,"Ordenar por..."),t.k0s(),t.j41(12,"option",9),t.EFF(13,"M\xe1s Vendidos"),t.k0s(),t.j41(14,"option",10),t.EFF(15,"Nombre"),t.k0s(),t.j41(16,"option",11),t.EFF(17,"Precio: De MENOR A MAYOR"),t.k0s(),t.j41(18,"option",12),t.EFF(19,"Precio: De MAYOR A MENOR"),t.k0s()()()()(),t.j41(20,"div",1)(21,"div",13),t.DNE(22,h,15,8,"div",14)(23,b,8,0,"div",15)(24,v,3,0,"div",15),t.k0s()(),t.DNE(25,C,9,5,"div",16),t.k0s()()(),t.j41(26,"div",17)(27,"div",18)(28,"div",19)(29,"div",20)(30,"h5",21),t.EFF(31,"Acceso requerido"),t.k0s(),t.j41(32,"button",22),t.bIt("click",function(){return o.closeLoginModal()}),t.k0s()(),t.j41(33,"div",23),t.EFF(34," Debes iniciar sesi\xf3n para ver tus favoritos. "),t.k0s(),t.j41(35,"div",24)(36,"a",25),t.EFF(37,"Iniciar sesi\xf3n"),t.k0s(),t.j41(38,"button",26),t.bIt("click",function(){return o.goToShop()}),t.EFF(39,"Ir a la tienda"),t.k0s()()()()()),2&n&&(t.R7$(9),t.R50("ngModel",o.selectedOrder),t.R7$(13),t.Y8G("ngForOf",o.paginatedFavorites),t.R7$(),t.Y8G("ngIf",0===o.favorites.length&&!o.loading),t.R7$(),t.Y8G("ngIf",o.loading),t.R7$(),t.Y8G("ngIf",o.totalPages>1),t.R7$(),t.xc7("display",o.showLoginModal?"block":"none"),t.AVh("show",o.showLoginModal))},dependencies:[l.MD,l.Sq,l.bT,g.iI,g.Wk,c.YN,c.xH,c.y7,c.wz,c.BC,c.vS],styles:[".container.favoritos[_ngcontent-%COMP%]{min-height:70vh}.h2[_ngcontent-%COMP%]{font-family:Roboto,sans-serif;font-size:30px!important;font-weight:300;color:#333;border-bottom:2px solid #b38449;padding-bottom:.5rem}.form-control[_ngcontent-%COMP%]{border:1px solid #e8e8e8;font-size:16px;padding:10px 15px;border-radius:4px}.form-control[_ngcontent-%COMP%]:focus{border-color:#b38449;box-shadow:0 0 0 .2rem #b3844940}.product-wap[_ngcontent-%COMP%]{box-shadow:0 5px 15px #0000001a;transition:transform .3s ease,box-shadow .3s ease;border-radius:8px;overflow:hidden;margin-bottom:2rem}.product-wap[_ngcontent-%COMP%]:hover{transform:translateY(-8px);box-shadow:0 15px 35px #0003}.product-wap[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{border:none}.product-wap[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{cursor:pointer;transition:transform .3s ease;height:250px;object-fit:cover;width:100%}.product-wap[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.product-wap[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:1.5rem;background-color:#fff}.product-name[_ngcontent-%COMP%]{font-size:1.1rem!important;font-weight:500;margin:1rem 0;color:#333;min-height:50px;display:flex;align-items:center;text-align:center}.btn-lg[_ngcontent-%COMP%]{padding:10px 15px;font-size:1rem;font-weight:500;border-radius:6px;transition:all .3s ease;min-width:50px}.btn-success[_ngcontent-%COMP%]{background-color:#b38449!important;border-color:#875d19!important;color:#fff}.btn-success[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#875d19!important;border-color:#875d19!important;transform:translateY(-2px);box-shadow:0 4px 15px #59ab6e66}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none!important;box-shadow:none!important}.btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.1rem}.text-center.mx-2[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:#b38449;min-width:80px}.pagination[_ngcontent-%COMP%]{margin-top:3rem}.page-link[_ngcontent-%COMP%]{color:#b38449;border-color:#dee2e6;padding:.75rem 1rem;margin:0 2px;transition:all .3s ease}.page-link[_ngcontent-%COMP%]:hover{background-color:#b38449;border-color:#b38449;color:#fff;transform:translateY(-1px)}.page-item.active[_ngcontent-%COMP%]   .page-link[_ngcontent-%COMP%]{background-color:#b38449;border-color:#b38449;color:#fff}.page-item.disabled[_ngcontent-%COMP%]   .page-link[_ngcontent-%COMP%]{color:#6c757d;background-color:#fff;border-color:#dee2e6;cursor:not-allowed}.border-pagination[_ngcontent-%COMP%]{border:1px solid #dee2e6!important}.alert[_ngcontent-%COMP%]{border-radius:10px;border:none;padding:2rem;margin:3rem 0;text-align:center}.alert-info[_ngcontent-%COMP%]{background-color:#d1ecf1;color:#0c5460;border-left:4px solid #17a2b8}.alert[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#0c5460;font-weight:600;margin-bottom:1rem}.alert[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:1.5rem;font-size:1.1rem}.modal[_ngcontent-%COMP%]{background-color:#00000080}.modal.show[_ngcontent-%COMP%]{display:block!important}.modal-content[_ngcontent-%COMP%]{border-radius:10px;border:none;box-shadow:0 15px 40px #0000004d}.modal-header[_ngcontent-%COMP%]{border-bottom:1px solid #e9ecef;padding:1.5rem;background-color:#f8f9fa;border-radius:10px 10px 0 0}.modal-title[_ngcontent-%COMP%]{font-weight:600;color:#333}.modal-body[_ngcontent-%COMP%]{padding:2rem;color:#666;font-size:1.1rem}.modal-footer[_ngcontent-%COMP%]{border-top:1px solid #e9ecef;padding:1.5rem;background-color:#f8f9fa;border-radius:0 0 10px 10px}.btn-close[_ngcontent-%COMP%]{background:none;border:none;font-size:1.5rem;cursor:pointer;opacity:.5}.btn-close[_ngcontent-%COMP%]:hover{opacity:1}.btn-primary[_ngcontent-%COMP%]{background-color:#007bff;border-color:#007bff;color:#fff;padding:10px 20px;border-radius:6px;transition:all .3s ease}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#0056b3;border-color:#0056b3;transform:translateY(-2px)}.btn-secondary[_ngcontent-%COMP%]{background-color:#6c757d;border-color:#6c757d;color:#fff;padding:10px 20px;border-radius:6px;transition:all .3s ease}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#545b62;border-color:#545b62;transform:translateY(-2px)}.text-center[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#666;font-weight:300;margin:3rem 0}@media (max-width: 768px){.col-md-4[_ngcontent-%COMP%]{flex:0 0 50%;max-width:50%;margin-bottom:1rem}.product-wap[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:200px}.product-name[_ngcontent-%COMP%]{font-size:1rem!important;min-height:40px}.btn-lg[_ngcontent-%COMP%]{padding:8px 12px;font-size:.9rem}.text-center.mx-2[_ngcontent-%COMP%]{font-size:1rem;min-width:70px}.pagination[_ngcontent-%COMP%]{justify-content:center!important}.h2[_ngcontent-%COMP%]{font-size:24px!important}}@media (max-width: 576px){.col-md-4[_ngcontent-%COMP%]{flex:0 0 100%;max-width:100%}.d-flex.align-items-center.justify-content-center[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem}.d-flex.align-items-center.justify-content-center[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin:0!important}.modal-body[_ngcontent-%COMP%]{padding:1.5rem}.modal-footer[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem}.modal-footer[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.product-wap[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .6s ease-out}a[role=button][_ngcontent-%COMP%]:hover{text-decoration:none}button[_ngcontent-%COMP%]:focus, a[_ngcontent-%COMP%]:focus{outline:2px solid #b38449;outline-offset:2px}a.text-decoration-none[_ngcontent-%COMP%]:hover{text-decoration:underline!important}.row[_ngcontent-%COMP%]{margin-left:-15px;margin-right:-15px}.col-md-4[_ngcontent-%COMP%]{padding-left:15px;padding-right:15px}"]})}}return a})()}}]);