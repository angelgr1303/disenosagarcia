"use strict";(self.webpackChunkdisenos_agarcia_frontend=self.webpackChunkdisenos_agarcia_frontend||[]).push([[727],{2727:(y,d,c)=>{c.r(d),c.d(d,{CartComponent:()=>k});var s=c(177),l=c(6544),t=c(4438),g=c(6868),u=c(7326),_=c(4796),p=c(2499);function m(r,a){1&r&&(t.j41(0,"div",20)(1,"p",21),t.EFF(2,"Cargando carrito..."),t.k0s()())}function f(r,a){if(1&r){const o=t.RV6();t.j41(0,"div",20)(1,"p"),t.EFF(2,"No tienes productos en tu carrito."),t.k0s(),t.j41(3,"button",22),t.bIt("click",function(){t.eBV(o);const e=t.XpG();return t.Njj(e.goToShop())}),t.EFF(4,"Ir a comprar"),t.k0s()()}}function b(r,a){if(1&r){const o=t.RV6();t.j41(0,"div",23)(1,"div",24)(2,"img",25),t.bIt("click",function(){const e=t.eBV(o).$implicit,i=t.XpG();return t.Njj(i.goToProduct(e.idProducto))}),t.k0s(),t.j41(3,"div",26)(4,"h6"),t.EFF(5),t.k0s(),t.j41(6,"p",27),t.EFF(7),t.k0s()(),t.j41(8,"button",28),t.bIt("click",function(){const e=t.eBV(o).$implicit,i=t.XpG();return t.Njj(i.removeFromCart(e.idProducto))}),t.nrm(9,"i",29),t.k0s()()()}if(2&r){const o=a.$implicit,n=t.XpG();t.R7$(2),t.Y8G("src",n.getProductImagePath(o),t.B4B)("alt",o.nombre),t.R7$(3),t.JRh(o.nombre),t.R7$(2),t.SpI("",o.precio," \u20ac"),t.R7$(),t.Y8G("disabled",n.loadingRemove)}}function h(r,a){if(1&r&&t.nrm(0,"li"),2&r){const o=a.index;t.AVh("active",0===o),t.BMQ("data-bs-target","#related-products-carousel")("data-bs-slide-to",o)}}function C(r,a){if(1&r&&(t.j41(0,"ol",37),t.DNE(1,h,1,4,"li",38),t.k0s()),2&r){const o=t.XpG(2);t.R7$(),t.Y8G("ngForOf",o.getFavoriteChunks())}}function P(r,a){if(1&r){const o=t.RV6();t.j41(0,"div",42)(1,"div",43)(2,"div",44)(3,"img",45),t.bIt("click",function(){const e=t.eBV(o).$implicit,i=t.XpG(3);return t.Njj(i.goToProduct(e.idProducto))}),t.k0s(),t.j41(4,"div",46)(5,"ul",47)(6,"li")(7,"button",48),t.bIt("click",function(){const e=t.eBV(o).$implicit,i=t.XpG(3);return t.Njj(i.addToCartFromFavorites(e.idProducto))}),t.nrm(8,"i",49),t.k0s()()()()(),t.j41(9,"div",50)(10,"h5",51),t.bIt("click",function(){const e=t.eBV(o).$implicit,i=t.XpG(3);return t.Njj(i.goToProduct(e.idProducto))}),t.EFF(11),t.k0s(),t.j41(12,"p",52),t.EFF(13),t.k0s()()()()}if(2&r){const o=a.$implicit,n=t.XpG(3);t.R7$(3),t.Y8G("src",n.getProductImagePath(o),t.B4B)("alt",o.nombre),t.R7$(4),t.Y8G("disabled",n.loadingCart),t.R7$(4),t.SpI(" ",o.nombre," "),t.R7$(2),t.SpI("",o.precio," \u20ac")}}function v(r,a){if(1&r&&(t.j41(0,"div",39)(1,"div",40),t.DNE(2,P,14,5,"div",41),t.k0s()()),2&r){const o=a.$implicit;t.AVh("active",0===a.index),t.R7$(2),t.Y8G("ngForOf",o)}}function M(r,a){1&r&&(t.j41(0,"a",53),t.nrm(1,"i",54),t.k0s())}function O(r,a){1&r&&(t.j41(0,"a",55),t.nrm(1,"i",56),t.k0s())}function x(r,a){if(1&r&&(t.j41(0,"div",30)(1,"div")(2,"h2"),t.EFF(3,"Tus Favoritos"),t.k0s(),t.j41(4,"div",31),t.DNE(5,C,2,1,"ol",32),t.j41(6,"div",33),t.DNE(7,v,3,3,"div",34),t.k0s(),t.DNE(8,M,2,0,"a",35)(9,O,2,0,"a",36),t.k0s()()()),2&r){const o=t.XpG();t.R7$(5),t.Y8G("ngIf",o.getFavoriteChunks().length>1),t.R7$(2),t.Y8G("ngForOf",o.getFavoriteChunks()),t.R7$(),t.Y8G("ngIf",o.getFavoriteChunks().length>1),t.R7$(),t.Y8G("ngIf",o.getFavoriteChunks().length>1)}}let k=(()=>{class r{constructor(o,n,e,i,F){this.cartService=o,this.favoriteService=n,this.authService=e,this.imageService=i,this.router=F,this.cartProducts=[],this.favoriteProducts=[],this.loading=!0,this.loadingRemove=!1,this.loadingCart=!1,this.subtotal=0,this.total=0,this.showLoginModalFlag=!1}ngOnInit(){this.checkAuthAndLoadCart()}checkAuthAndLoadCart(){this.authService.isAuthenticated()?(this.loadCart(),this.loadFavorites()):this.showLoginModal()}loadCart(){this.loading=!0,this.cartService.getCart().subscribe({next:o=>{this.loading=!1,"success"===o.status?(this.cartProducts=(o.carrito||[]).map(n=>({id:n.id,idProducto:n.idProducto,nombre:n.nombre,precio:n.precio,foto:n.foto,categoria:n.categoria||"",subcategoria:n.subcategoria||""})),this.calculateTotals()):(this.cartProducts=[],this.calculateTotals())},error:o=>{this.loading=!1,console.error("Error al cargar carrito:",o),401===o.status&&this.showLoginModal()}})}loadFavorites(){this.favoriteService.getFavorites().subscribe({next:o=>{"success"===o.status&&(this.favoriteProducts=o.favoritos||[])},error:o=>{console.error("Error al cargar favoritos:",o)}})}removeFromCart(o){this.loadingRemove=!0,this.cartService.removeFromCart(o).subscribe({next:n=>{this.loadingRemove=!1,"success"===n.status&&this.loadCart()},error:n=>{this.loadingRemove=!1,console.error("Error al eliminar del carrito:",n)}})}addToCartFromFavorites(o){this.loadingCart=!0,this.cartService.addToCart(o).subscribe({next:n=>{this.loadingCart=!1,"success"===n.status&&(this.loadCart(),this.favoriteProducts=this.favoriteProducts.filter(e=>e.idProducto!==o))},error:n=>{this.loadingCart=!1,console.error("Error al a\xf1adir al carrito:",n)}})}calculateTotals(){this.subtotal=this.cartProducts.reduce((o,n)=>o+n.precio,0),this.total=this.subtotal}getFavoriteChunks(){const n=[];for(let e=0;e<this.favoriteProducts.length;e+=3)n.push(this.favoriteProducts.slice(e,e+3));return n}getProductImagePath(o){return this.imageService.getProductImagePath({category:o.categoria,subcategory:o.subcategoria,image:o.foto})}goToProduct(o){this.router.navigate(["/product",o])}goToShop(){this.router.navigate(["/shop"])}proceedToPayment(){alert("Funcionalidad de pago en desarrollo")}showLoginModal(){this.showLoginModalFlag=!0}closeLoginModal(){this.showLoginModalFlag=!1}goToLogin(){this.closeLoginModal(),this.router.navigate(["/login"])}static{this.\u0275fac=function(n){return new(n||r)(t.rXU(g.m),t.rXU(u.U),t.rXU(_.u),t.rXU(p.f),t.rXU(l.Ix))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-cart"]],standalone:!0,features:[t.aNF],decls:38,vars:12,consts:[[1,"container-carrito"],[1,"carrito-section"],["id","carrito-container"],["class","text-center",4,"ngIf"],["class","producto-card card mb-3 product-wap rounded-0",4,"ngFor","ngForOf"],[1,"resumen-section"],["id","subtotal"],["id","total"],[1,"btn","btn-primary","w-100",3,"click","disabled"],["class","container favoritos-section mt-5",4,"ngIf"],["tabindex","-1","aria-labelledby","loginAlertModalLabel",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","loginAlertModalLabel",1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-success",3,"click"],[1,"text-center"],[1,"h4"],[1,"btn","btn-primary",3,"click"],[1,"producto-card","card","mb-3","product-wap","rounded-0"],[1,"card-body","d-flex","align-items-center"],[1,"rounded","img-fluid",2,"width","80px","height","80px","object-fit","cover","cursor","pointer",3,"click","src","alt"],[1,"ms-3"],[1,"precio"],["type","button",1,"btn","btn-danger","ms-auto",3,"click","disabled"],[1,"fas","fa-trash"],[1,"container","favoritos-section","mt-5"],["id","related-products-carousel","data-bs-ride","carousel",1,"carousel","slide"],["class","carousel-indicators",4,"ngIf"],[1,"carousel-inner"],["class","carousel-item",3,"active",4,"ngFor","ngForOf"],["class","carousel-control-prev text-decoration-none w-auto ps-3","href","#related-products-carousel","role","button","data-bs-slide","prev",4,"ngIf"],["class","carousel-control-next text-decoration-none w-auto pe-3","href","#related-products-carousel","role","button","data-bs-slide","next",4,"ngIf"],[1,"carousel-indicators"],[3,"active",4,"ngFor","ngForOf"],[1,"carousel-item"],[1,"row"],["class","col-md-4 mb-4",4,"ngFor","ngForOf"],[1,"col-md-4","mb-4"],[1,"card","h-100","product-wap","rounded-0"],[1,"card","rounded-0"],[1,"card-img-top","rounded-0","img-fluid",2,"cursor","pointer",3,"click","src","alt"],[1,"card-img-overlay","rounded-0","product-overlay","d-flex","align-items-center","justify-content-center"],[1,"list-unstyled"],[1,"btn","btn-success","btn-square","text-white",3,"click","disabled"],[1,"far","fa-heart"],[1,"card-body"],[1,"h6","card-title",2,"cursor","pointer",3,"click"],[1,"text-center","mb-0","precio"],["href","#related-products-carousel","role","button","data-bs-slide","prev",1,"carousel-control-prev","text-decoration-none","w-auto","ps-3"],[1,"fas","fa-chevron-left"],["href","#related-products-carousel","role","button","data-bs-slide","next",1,"carousel-control-next","text-decoration-none","w-auto","pe-3"],[1,"fas","fa-chevron-right"]],template:function(n,e){1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"h2"),t.EFF(3,"Tu Cesta"),t.k0s(),t.j41(4,"div",2),t.DNE(5,m,3,0,"div",3)(6,f,5,0,"div",3)(7,b,10,5,"div",4),t.k0s()(),t.j41(8,"div",5)(9,"div")(10,"h2"),t.EFF(11,"Resumen"),t.k0s()(),t.j41(12,"p"),t.EFF(13,"Subtotal: "),t.j41(14,"span",6),t.EFF(15),t.k0s()(),t.j41(16,"p")(17,"strong"),t.EFF(18,"Total: "),t.j41(19,"span",7),t.EFF(20),t.k0s()()(),t.j41(21,"button",8),t.bIt("click",function(){return e.proceedToPayment()}),t.EFF(22," Pagar "),t.k0s()()(),t.DNE(23,x,10,4,"div",9),t.j41(24,"div",10)(25,"div",11)(26,"div",12)(27,"div",13)(28,"h5",14),t.EFF(29,"Iniciar Sesi\xf3n Requerido"),t.k0s(),t.j41(30,"button",15),t.bIt("click",function(){return e.closeLoginModal()}),t.k0s()(),t.j41(31,"div",16),t.EFF(32," Debes iniciar sesi\xf3n para acceder a tu carrito. "),t.k0s(),t.j41(33,"div",17)(34,"button",18),t.bIt("click",function(){return e.closeLoginModal()}),t.EFF(35,"Cerrar"),t.k0s(),t.j41(36,"button",19),t.bIt("click",function(){return e.goToLogin()}),t.EFF(37,"Iniciar Sesi\xf3n"),t.k0s()()()()()),2&n&&(t.R7$(5),t.Y8G("ngIf",e.loading),t.R7$(),t.Y8G("ngIf",!e.loading&&0===e.cartProducts.length),t.R7$(),t.Y8G("ngForOf",e.cartProducts),t.R7$(8),t.SpI("",e.subtotal.toFixed(2)," \u20ac"),t.R7$(5),t.SpI("",e.total.toFixed(2)," \u20ac"),t.R7$(),t.Y8G("disabled",0===e.cartProducts.length),t.R7$(2),t.Y8G("ngIf",e.favoriteProducts.length>0),t.R7$(),t.xc7("display",e.showLoginModalFlag?"block":"none"),t.AVh("show",e.showLoginModalFlag),t.BMQ("aria-hidden",!e.showLoginModalFlag))},dependencies:[s.MD,s.Sq,s.bT,l.iI],styles:[".container-carrito[_ngcontent-%COMP%]{display:flex;gap:2rem;max-width:1200px;margin:2rem auto;padding:0 1rem}.carrito-section[_ngcontent-%COMP%]{flex:2;background:#fff;padding:1.5rem;border-radius:8px;box-shadow:0 2px 10px #0000001a;height:-moz-fit-content;height:fit-content}.carrito-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-family:Roboto,sans-serif;font-size:28px;font-weight:300;color:#333;margin-bottom:1.5rem;border-bottom:2px solid #b38449;padding-bottom:.5rem}.producto-card[_ngcontent-%COMP%]{transition:transform .2s ease,box-shadow .2s ease;border:1px solid #e0e0e0}.producto-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 15px #0000001a}.producto-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:1rem}.producto-card[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{font-family:Roboto,sans-serif;font-size:16px;font-weight:500;color:#333;margin-bottom:.5rem;cursor:pointer}.producto-card[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]:hover{color:#b38449}.producto-card[_ngcontent-%COMP%]   .precio[_ngcontent-%COMP%]{font-family:Roboto,sans-serif;font-size:16px;font-weight:600;color:#b38449;margin:0}.producto-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:4px;transition:transform .3s ease}.producto-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.btn-danger[_ngcontent-%COMP%]{background-color:#dc3545;border-color:#dc3545;color:#fff;padding:.5rem .75rem;border-radius:4px;transition:all .3s ease}.btn-danger[_ngcontent-%COMP%]:hover{background-color:#c82333;border-color:#bd2130;transform:translateY(-1px)}.btn-danger[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.resumen-section[_ngcontent-%COMP%]{flex:1;background:#fff;padding:1.5rem;border-radius:8px;box-shadow:0 2px 10px #0000001a;height:-moz-fit-content;height:fit-content;position:sticky;top:2rem}.resumen-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-family:Roboto,sans-serif;font-size:24px;font-weight:300;color:#333;margin-bottom:1.5rem;border-bottom:2px solid #b38449;padding-bottom:.5rem}.resumen-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-family:Roboto,sans-serif;font-size:16px;font-weight:400;color:#333;margin-bottom:1rem;display:flex;justify-content:space-between;align-items:center}.resumen-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-weight:600;font-size:18px}#subtotal[_ngcontent-%COMP%], #total[_ngcontent-%COMP%]{font-weight:600;color:#b38449}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#b38449,#875d19);border:none;border-radius:6px;padding:.875rem 1.5rem;font-size:16px;font-weight:500;font-family:Roboto,sans-serif;transition:all .3s ease;text-transform:uppercase;letter-spacing:.5px}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:linear-gradient(135deg,#875d19,#6b4914);transform:translateY(-2px);box-shadow:0 6px 20px #b3844966}.btn-primary[_ngcontent-%COMP%]:disabled{background:#6c757d;cursor:not-allowed;transform:none;box-shadow:none}.favoritos-section[_ngcontent-%COMP%]{margin-top:3rem;background:#fff;padding:2rem;border-radius:8px;box-shadow:0 2px 10px #0000001a}.favoritos-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-family:Roboto,sans-serif;font-size:28px;font-weight:300;color:#333;margin-bottom:2rem;border-bottom:2px solid #b38449;padding-bottom:.5rem}.carousel[_ngcontent-%COMP%]{position:relative}.carousel-indicators[_ngcontent-%COMP%]{position:relative;margin-bottom:2rem;margin-top:0}.carousel-indicators[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{background-color:#b38449;width:12px;height:12px;border-radius:50%;margin:0 4px}.carousel-control-prev[_ngcontent-%COMP%], .carousel-control-next[_ngcontent-%COMP%]{width:auto;color:#b38449;font-size:1.5rem}.carousel-control-prev[_ngcontent-%COMP%]:hover, .carousel-control-next[_ngcontent-%COMP%]:hover{color:#875d19}.product-wap[_ngcontent-%COMP%]{transition:transform .3s ease,box-shadow .3s ease;border:1px solid #e0e0e0}.product-wap[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 8px 25px #00000026}.product-overlay[_ngcontent-%COMP%]{background:#000000b3;opacity:0;transition:opacity .3s ease}.card[_ngcontent-%COMP%]:hover   .product-overlay[_ngcontent-%COMP%]{opacity:1}.btn-square[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:50%;display:flex;align-items:center;justify-content:center}.btn-success[_ngcontent-%COMP%]{background-color:#b38449!important;border-color:#875d19!important;color:#fff;transition:all .3s ease}.btn-success[_ngcontent-%COMP%]:hover{background-color:#875d19!important;border-color:#875d19!important;transform:scale(1.1)}.card-title[_ngcontent-%COMP%]{font-family:Roboto,sans-serif;font-size:16px;font-weight:500;color:#333;transition:color .3s ease}.card-title[_ngcontent-%COMP%]:hover{color:#b38449}.text-center[_ngcontent-%COMP%]   p.h4[_ngcontent-%COMP%]{color:#6c757d;font-family:Roboto,sans-serif;font-weight:300}.modal-header[_ngcontent-%COMP%]{border-bottom:2px solid #b38449;background:linear-gradient(135deg,#b38449,#875d19);color:#fff}.modal-title[_ngcontent-%COMP%]{font-family:Roboto,sans-serif;font-weight:400}.modal-body[_ngcontent-%COMP%]{font-family:Roboto,sans-serif;font-weight:300;line-height:1.6}.modal-footer[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]{background-color:#6c757d;border-color:#6c757d}.modal-footer[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#b38449,#875d19);border:none}@media (max-width: 1024px){.container-carrito[_ngcontent-%COMP%]{flex-direction:column;gap:1.5rem}.resumen-section[_ngcontent-%COMP%]{position:static;order:-1}}@media (max-width: 768px){.container-carrito[_ngcontent-%COMP%]{padding:0 .5rem;margin:1rem auto}.carrito-section[_ngcontent-%COMP%], .resumen-section[_ngcontent-%COMP%], .favoritos-section[_ngcontent-%COMP%]{padding:1rem}.carrito-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .resumen-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .favoritos-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;margin-bottom:1rem}.producto-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:.75rem}.producto-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:60px!important;height:60px!important}.producto-card[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%], .producto-card[_ngcontent-%COMP%]   .precio[_ngcontent-%COMP%]{font-size:14px}}@media (max-width: 576px){.producto-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{flex-direction:column;text-align:center;gap:1rem}.producto-card[_ngcontent-%COMP%]   .ms-3[_ngcontent-%COMP%], .producto-card[_ngcontent-%COMP%]   .ms-auto[_ngcontent-%COMP%]{margin-left:0!important}.btn-danger[_ngcontent-%COMP%]{width:100%}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.producto-card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-out}.resumen-section[_ngcontent-%COMP%], .carrito-section[_ngcontent-%COMP%]{background:linear-gradient(145deg,#fff,#f8f9fa)}.producto-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]:hover   h6[_ngcontent-%COMP%]{color:#b38449}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.loading-spinner[_ngcontent-%COMP%]{width:1rem;height:1rem;border:2px solid transparent;border-top:2px solid currentColor;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.btn[_ngcontent-%COMP%]:focus, .card[_ngcontent-%COMP%]:focus, .card-title[_ngcontent-%COMP%]:focus{outline:2px solid #b38449;outline-offset:2px}"]})}}return r})()}}]);